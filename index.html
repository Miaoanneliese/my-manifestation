<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>我的生活・投資手帖</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600&family=Noto+Sans+TC:wght@300;400;500&family=Material+Icons+Round&display=swap" rel="stylesheet">
    <style>
      :root { --bg-color: #F7F7F2; --card-bg: #FFFFFF; --text-main: #404040; --text-sub: #7F7F7F; --border-color: #E0E0E0; --muji-red: #7F0019; --muji-green: #6c8c6e; --accent-brown: #8D8170; --btn-green: #597e5d; --table-header-bg: #f2f0eb; }
      * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
      body { margin: 0; font-family: 'Noto Sans TC', sans-serif; background-color: var(--bg-color); color: var(--text-main); padding-bottom: 80px; }
      header { background-color: var(--bg-color); padding: 25px 20px 10px; }
      .date-weather-box { display: flex; justify-content: space-between; align-items: flex-end; border-bottom: 1px solid var(--text-main); padding-bottom: 10px; }
      .current-date { font-family: 'Noto Serif TC', serif; font-size: 1.5rem; font-weight: 900; }
      .day-tag { font-size: 0.9rem; margin-left: 5px; color: var(--text-sub); }
      .weather-info { display: flex; align-items: center; font-size: 0.9rem; color: var(--text-sub); gap: 5px; }
      main { padding: 20px; }
      
      .muji-card { background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 4px; padding: 15px 20px; margin-bottom: 15px; position: relative; box-shadow: none; display: flex; flex-direction: column; }
      .card-label { font-size: 0.75rem; color: var(--text-sub); margin-bottom: 8px; letter-spacing: 1px; font-weight: 500; }
      .muji-title { font-family: 'Noto Serif TC', serif; font-size: 1.4rem; margin: 10px 0 20px; text-align: center; color: var(--muji-red); }
      .big-number { font-size: 1.6rem; font-weight: 300; font-family: 'Noto Serif TC', serif; }
      
      .dashboard-grid { display: flex; gap: 10px; margin-bottom: 15px; align-items: stretch; }
      .schedule-card { flex: 3; margin-bottom: 0; }
      .right-col { flex: 2; display: flex; flex-direction: column; gap: 10px; }
      .goal-card, .quote-card { flex: 1; margin-bottom: 0; }
      
      /* --- Goal Card Styles (Year/Season/Cycle) --- */
      .goal-card { padding: 0 !important; overflow: hidden; }
      .goal-header-group { display: flex; justify-content: space-between; align-items: center; padding: 12px 15px 8px; border-bottom: 1px solid #eee; background: #fff; flex-shrink: 0; }
      .cycle-badge { background-color: var(--muji-red); color: white; font-size: 0.75rem; padding: 2px 8px; border-radius: 10px; font-weight: 500; letter-spacing: 0.5px; box-shadow: 0 1px 3px rgba(127,0,25,0.2); }
      
      .macro-goal-container { background-color: #fafafa; padding: 10px 15px; border-bottom: 1px solid #eee; flex-shrink: 0; }
      .macro-row { display: flex; align-items: baseline; margin-bottom: 6px; }
      .macro-row:last-child { margin-bottom: 0; }
      .macro-label { font-size: 0.7rem; color: #fff; background-color: var(--accent-brown); padding: 1px 6px; border-radius: 2px; margin-right: 8px; flex-shrink: 0; letter-spacing: 1px; font-weight: 400; }
      .macro-label.season { background-color: #aeb6bf; }
      .macro-text { font-family: 'Noto Serif TC', serif; font-size: 0.85rem; color: var(--text-main); line-height: 1.4; letter-spacing: 0.5px; }

      .cycle-list-container { flex: 1; overflow-y: auto; padding: 5px 15px 12px; background: #fff; min-height: 0; }
      .cycle-list-container::-webkit-scrollbar { width: 4px; } 
      .cycle-list-container::-webkit-scrollbar-thumb { background-color: #eee; border-radius: 4px; }
      
      .cycle-list-item { padding: 8px 0; border-bottom: 1px dashed #eee; display: flex; align-items: flex-start; }
      .cycle-list-item:last-child { border-bottom: none; }
      .cycle-cat { color: var(--muji-red); font-weight: 600; margin-right: 8px; white-space: nowrap; font-size: 0.8rem; margin-top: 1px; min-width: 32px; }
      .cycle-desc { color: #555; font-size: 0.85rem; line-height: 1.5; }

      .quote-text { font-family: 'Noto Serif TC', serif; font-size: 0.85rem; line-height: 1.4; color: var(--accent-brown); flex: 1; display: flex; align-items: center; }

      /* --- General & Form Styles --- */
      .action-btn-container { width: 55px; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; border-radius: 4px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); text-decoration: none; }
      .action-btn-container:active { transform: scale(0.95); }
      .record-btn { background: var(--muji-red); color: white; }
      .btn-icon span { font-size: 26px; margin-bottom: 2px; }
      .btn-text { font-size: 0.75rem; letter-spacing: 1px; writing-mode: vertical-rl; text-orientation: upright; }

      .calendar-list { list-style: none; padding: 0; margin: 0; flex: 1; }
      .calendar-list li { padding: 8px 0; border-bottom: 1px dashed #eee; font-size: 0.85rem; display: flex; justify-content: space-between; align-items: center; width: 100%; overflow: hidden; }
      .cal-date { margin-right: 5px; font-weight: 600; color: var(--accent-brown); flex-shrink: 0; }
      .cal-title-wrapper { flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; display: block; color: #555; }
      
      input[type="text"], input[type="number"], input[type="date"], select, textarea { width: 100%; padding: 12px; font-size: 0.95rem; color: #333; border: 1px solid #ddd; border-radius: 3px; background-color: #fafafa; outline: none; box-sizing: border-box; transition: border-color 0.2s; }
      input:focus, textarea:focus, select:focus { border-color: #999; background: #fff; }
      .input-group { margin-bottom: 15px; }
      label { display: block; font-size: 0.8rem; color: #888; margin-bottom: 4px; }
      .flex-row { display: flex; gap: 8px; } .flex-col { flex: 1; }
      .btn-muji { width: 100%; padding: 15px; background: #333; color: white; border: none; font-size: 1rem; cursor: pointer; margin-top: 15px; border-radius: 3px; letter-spacing: 1px; transition: background 0.2s; }
      .btn-muji:active { background-color: #000; }
      
      .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; background: #fff; border-top: 1px solid var(--border-color); display: grid; grid-template-columns: 1fr 1fr 1fr; height: 56px; align-items: center; z-index: 1000; padding-bottom: env(safe-area-inset-bottom); }
      .nav-btn { background: none; border: none; color: #bbb; height: 100%; padding: 0; cursor: pointer; display: flex; justify-content: center; align-items: center; }
      .nav-btn.active { color: #333; }
      .nav-btn .material-icons-round { font-size: 28px; }
      
      .tab-content { display: none; } .tab-content.active { display: block; animation: fadeIn 0.3s; }
      .mode-select-container { display: flex; flex-direction: column; gap: 10px; padding: 20px; justify-content: center; height: 50vh; }
      .mode-btn { padding: 15px; font-size: 1rem; border: 1px solid #ddd; background: #fff; border-radius: 4px; color: #555; text-align: center; cursor: pointer; display: flex; flex-direction: row; justify-content: center; align-items: center; gap: 10px; }
      .mode-btn:active { background: #f0f0f0; }
      .operation-container { padding-bottom: 70px; max-width: 600px; margin: 0 auto; }
      .hidden { display: none !important; }
      .mini-select { font-size: 0.85rem; padding: 5px; height: 32px; }
      .tech-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 10px; }
      .tech-item label { font-size: 0.75rem; margin-bottom: 2px; display: block; }
      @keyframes fadeIn { from {opacity: 0;} to {opacity: 1;} }
    </style>
</head>
<body>
    <header>
      <div class="date-weather-box">
        <div class="current-date"><span id="header-date">...</span> <span id="header-day" class="day-tag">...</span></div>
        <div class="weather-info" id="weather-display"><span class="material-icons-round">wb_sunny</span> <span>讀取中...</span></div>
      </div>
    </header>
    <main id="app">
      <div id="tab-dashboard" class="tab-content active">
          <div class="dashboard-grid">
            <div class="muji-card schedule-card">
                <div class="card-label">SCHEDULE</div>
                <ul class="calendar-list" id="calendar-list-display">
                    <li><span class="cal-date">--:--</span><span class="cal-title-wrapper">載入中...</span></li>
                </ul>
            </div>
            
            <div class="right-col">
                <div class="muji-card goal-card">
                    <div class="goal-header-group">
                        <div class="card-label" style="margin:0;">目標實踐</div>
                        <div class="cycle-badge" id="goal-cycle-badge">第 01 期</div>
                    </div>

                    <div class="macro-goal-container">
                        <div class="macro-row">
                            <span class="macro-label">年</span>
                            <span class="macro-text" id="goal-year-text">2026 全方位自我優化</span>
                        </div>
                        <div class="macro-row">
                            <span class="macro-label season">季</span>
                            <span class="macro-text" id="goal-season-text">Q1 節目改版 / 資產重整</span>
                        </div>
                    </div>

                    <div class="cycle-list-container" id="goal-cycle-list">
                        <div class="cycle-list-item">
                            <span class="cycle-cat">工作</span>
                            <span class="cycle-desc">英語提案翻譯與潤飾</span>
                        </div>
                        <div class="cycle-list-item">
                            <span class="cycle-cat">生活</span>
                            <span class="cycle-desc">Pixel 10 設定與測試</span>
                        </div>
                        <div class="cycle-list-item">
                            <span class="cycle-cat">習慣</span>
                            <span class="cycle-desc">Air Shot 紀錄確認</span>
                        </div>
                    </div>
                </div>

                <div class="muji-card quote-card">
                    <div class="card-label">QUOTE</div>
                    <div class="quote-text">"Less is more."</div>
                </div>
            </div>
          </div>
      </div>

      <div id="tab-operation" class="tab-content">
        <div class="muji-title">操作紀錄</div>
        <div id="op-selection" class="mode-select-container">
          <div class="mode-btn" onclick="selectMode('swing')"><span class="material-icons-round">trending_up</span> 波段操作</div>
          <div class="mode-btn" onclick="selectMode('daytrade')"><span class="material-icons-round">flash_on</span> 當沖交易</div>
        </div>
        
        <div id="form-swing" class="operation-container hidden">
          <div class="muji-card">
            <div style="display:flex; align-items:center; margin-bottom:15px; color:#888; font-size:0.9rem; cursor:pointer;" onclick="backToSelection()">
               <span class="material-icons-round" style="font-size:18px; margin-right:4px;">arrow_back</span> 返回
            </div>
            <form id="stockForm">
              <div class="input-group"><label>日期</label><input type="date" id="s_date" required></div>
              <div class="flex-row"><div class="flex-col input-group"><label>代號</label><input type="text" id="s_code" placeholder="2330" required inputmode="numeric"></div><div class="flex-col input-group"><label>名稱</label><input type="text" id="s_name" placeholder="台積電" required></div></div>
              <div class="flex-row"><div class="flex-col input-group"><label>股數</label><input type="number" id="s_shares" placeholder="1000" inputmode="numeric"></div><div class="flex-col input-group"><label>價格</label><input type="number" id="s_price" step="0.01" inputmode="decimal"></div></div>
              <div class="input-group"><label>交割價</label><input type="number" id="s_settlement" step="1" inputmode="decimal"></div>
              <div class="flex-row"><div class="flex-col input-group"><label>趨勢</label><select id="s_trend"><option value="多">多</option><option value="空">空</option></select></div><div class="flex-col input-group"><label>動作</label><select id="s_action" style="background-color: #fffef0;"><option value="進場">進場</option><option value="出場">出場</option></select></div></div>
              <div class="input-group"><label id="reasonLabel" style="color: #d35400;">進場條件</label><select id="s_reason" style="border-color: #e6b0aa;"></select></div>
              <details>
                  <summary>技術分析 (選填)</summary>
                  <div class="tech-grid">
                      <div class="tech-item"><label>周趨勢</label><select id="s_weekTrend" class="mini-select"><option></option><option>多</option><option>空</option><option>盤整</option></select></div>
                      <div class="tech-item"><label>日趨勢</label><select id="s_dayTrend" class="mini-select"><option></option><option>多</option><option>空</option><option>盤整</option></select></div>
                      <div class="tech-item"><label>位置</label><select id="s_position" class="mini-select"><option></option><option>起漲</option><option>走勢高檔</option><option>趨勢高檔</option><option>頭部</option><option>行進間</option><option>起跌</option><option>走勢低檔</option><option>趨勢低檔</option><option>底部</option></select></div>
                      <div class="tech-item"><label>成交量</label><select id="s_volume" class="mini-select"><option></option><option>價↑量↑</option><option>價↑量-</option><option>價↑量↓</option><option>價↓量↑</option><option>價↓量-</option><option>價量↓</option></select></div>
                      <div class="tech-item"><label>20T</label><select id="s_ma20t" class="mini-select"><option></option><option>↑20T↑</option><option>↑20T</option><option>-20T-</option><option>↓20T↑</option></select></div>
                      <div class="tech-item"><label>備註</label><input type="text" class="mini-select" placeholder="..."></div>
                  </div>
              </details>
              <button type="submit" class="btn-muji">記錄波段</button>
            </form>
          </div>
        </div>
      </div>

      <div id="tab-journal" class="tab-content">
          <div class="muji-title">生活隨筆</div>
          <div class="muji-card" style="text-align:center; padding:30px; color:#aaa;">
              功能開發中...
          </div>
      </div>
    </main>

    <nav class="bottom-nav">
        <button class="nav-btn active" onclick="switchTab('dashboard')"><span class="material-icons-round">dashboard</span></button>
        <button class="nav-btn" onclick="switchTab('operation')"><span class="material-icons-round">edit_note</span></button>
        <button class="nav-btn" onclick="switchTab('journal')"><span class="material-icons-round">book</span></button>
    </nav>

    <div id="toast">訊息</div>

    <script>
       // 初始化日期
       const now = new Date();
       const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
       document.getElementById('header-date').innerText = (now.getMonth()+1) + '.' + now.getDate();
       document.getElementById('header-day').innerText = days[now.getDay()];

       // Tab 切換
       function switchTab(tabId) {
           document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
           document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
           
           document.getElementById('tab-' + tabId).classList.add('active');
           
           const btns = document.querySelectorAll('.nav-btn');
           if(tabId === 'dashboard') btns[0].classList.add('active');
           if(tabId === 'operation') btns[1].classList.add('active');
           if(tabId === 'journal') btns[2].classList.add('active');
       }

       // 操作模式切換
       function selectMode(mode) {
           document.getElementById('op-selection').classList.add('hidden');
           if(mode === 'swing') document.getElementById('form-swing').classList.remove('hidden');
           // 如果有當沖表單可在此擴充
       }
       
       function backToSelection() {
           document.getElementById('form-swing').classList.add('hidden');
           document.getElementById('op-selection').classList.remove('hidden');
       }
    </script>
</body>
</html>
